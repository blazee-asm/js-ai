<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="icon" href="favicon.png" type="image/png" />
        <style>
            :root {
                --fill-space: 100%
            }


            #input {
                position: absolute;
                left: 50%;
                top: 90%;
                width: 400px;
                height: 10%;
                border: 2px solid #ccc;
                border-radius: 8px;
                transform: translate(-50%, -50%);
            }

            #inputbox {
                border: none;
                width: calc(var(--fill-space) - 8px);
                height: 50%;
            }

            #enter {
                position: absolute;
                font-size: 24px;
                border: none;
                border-radius: 100%;
                left: 400px;
                top: 100%;
                width: 40px;
                height: 40px;
                transform: translate(-100%, -100%);
                background-color: #000;
                color: #ccc;
            }
            #enter:hover {
                background-color: #444;
                cursor: pointer;
            }
            #enter:active {
                background-color: #888;
            }
        </style>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
    </head>
    <body>
        <div id="input">
            <input type="text" id="inputbox" placeholder="message JS-AI here..." />
            <button id="enter">&#x2B06;</button>
        </div>
        <p id="response"></p>
        <script>

            function getRandomChoice(arr) {
                return arr[Math.floor(Math.random() * arr.length)]
            }

            const hoverMessages = [
                "C'mon, tell me!",
                "Just press it.",
                "I'm waiting...",
                "I don't bite!",
                "One click is all it takes."
            ];
            
            const inputBox = document.getElementById("inputbox")
            const enterBtn = document.getElementById("enter")
            const responseText = document.getElementById("response")

            let context = ""

            enterBtn.addEventListener("mouseenter", () => {
                responseText.innerText = getRandomChoice(hoverMessages)
            })
            enterBtn.addEventListener("click", async () => {
                let message = inputBox.value
                inputBox.value = ""
                try {
                    const response = await fetch('https://cf8a4a82-110a-4d5e-8254-b989ef52ff72-00-12f77o19b4pu3.spock.replit.dev/api/message', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ message: message, context: context })
                    });

                    if (!response.ok) {
                        throw new Error(`Server error: ${response.status}`);
                    }

                    const data = await response.json();
                    responseText.innerHTML = data.message
                    context = data.newContext
                } catch (error) {
                    console.error('Error fetching from backend:', error);
                    responseText.innerHTML = "Sorry, something went wrong.";
                }
            })
        </script>
    </body>
</html>